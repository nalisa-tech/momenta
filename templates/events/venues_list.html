{% extends 'base.html' %}
{% load static %}

{% block title %}Venues - Momenta{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header Section -->
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">ğŸ¢ Event Venues</h1>
        <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Discover premium venues across Zambia for your events. From intimate conference rooms to massive stadiums.
        </p>
    </div>

    <!-- Search and Filter Section -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
        <form method="GET" class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <!-- Search -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Search Venues</label>
                <input type="text" name="search" value="{{ search_query }}" 
                       placeholder="Search by name, location, facilities..."
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <!-- Capacity Filter -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Capacity</label>
                <select name="capacity" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">All Sizes</option>
                    <option value="small" {% if capacity_filter == 'small' %}selected{% endif %}>Small (< 1,000)</option>
                    <option value="medium" {% if capacity_filter == 'medium' %}selected{% endif %}>Medium (1,000 - 10,000)</option>
                    <option value="large" {% if capacity_filter == 'large' %}selected{% endif %}>Large (10,000+)</option>
                </select>
            </div>

            <!-- Price Filter -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Price Range</label>
                <select name="price" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">All Prices</option>
                    <option value="budget" {% if price_filter == 'budget' %}selected{% endif %}>Budget (< K1,000/hr)</option>
                    <option value="mid" {% if price_filter == 'mid' %}selected{% endif %}>Mid-range (K1,000 - K2,000/hr)</option>
                    <option value="premium" {% if price_filter == 'premium' %}selected{% endif %}>Premium (K2,000+/hr)</option>
                </select>
            </div>

            <!-- Search Button -->
            <div class="flex items-end">
                <button type="submit" class="w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-300">
                    ğŸ” Search
                </button>
            </div>
        </form>
    </div>

    <!-- Results Summary -->
    <div class="mb-6">
        <p class="text-gray-600">
            <span class="font-semibold">{{ total_venues }}</span> venue{{ total_venues|pluralize }} found
            {% if search_query %}for "{{ search_query }}"{% endif %}
        </p>
    </div>

    <!-- Venues Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for venue in venues %}
        <div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-300">
            <!-- Venue Header -->
            <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4">
                <h3 class="text-xl font-bold mb-2">{{ venue.name }}</h3>
                <p class="text-blue-100 text-sm">ğŸ“ {{ venue.address|truncatechars:50 }}</p>
            </div>

            <!-- Venue Details -->
            <div class="p-6">
                <!-- Capacity and Rate -->
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-blue-600">{{ venue.capacity|floatformat:0 }}</div>
                        <div class="text-sm text-gray-600">Capacity</div>
                    </div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-green-600">K{{ venue.hourly_rate|floatformat:0 }}</div>
                        <div class="text-sm text-gray-600">Per Hour</div>
                    </div>
                </div>

                <!-- Facilities -->
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ—ï¸ Facilities</h4>
                    <p class="text-sm text-gray-600">{{ venue.facilities|truncatechars:100 }}</p>
                </div>

                <!-- Contact Info -->
                {% if venue.contact_person or venue.contact_phone %}
                <div class="mb-4">
                    <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ Contact</h4>
                    {% if venue.contact_person %}
                        <p class="text-sm text-gray-600">ğŸ‘¤ {{ venue.contact_person }}</p>
                    {% endif %}
                    {% if venue.contact_phone %}
                        <p class="text-sm text-gray-600">ğŸ“± {{ venue.contact_phone }}</p>
                    {% endif %}
                </div>
                {% endif %}

                <!-- Action Buttons -->
                <div class="flex gap-2">
                    <a href="{% url 'events:venue_detail' venue.id %}" 
                       class="flex-1 bg-blue-600 text-white text-center py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300">
                        ğŸ“‹ View Details
                    </a>
                    {% if venue.contact_phone %}
                    <a href="tel:{{ venue.contact_phone }}" 
                       class="bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition duration-300">
                        ğŸ“
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-span-full text-center py-12">
            <div class="text-6xl mb-4">ğŸ¢</div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">No Venues Found</h3>
            <p class="text-gray-600 mb-4">Try adjusting your search criteria or browse all venues.</p>
            <a href="{% url 'events:venues_list' %}" class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-300">
                View All Venues
            </a>
        </div>
        {% endfor %}
    </div>

    <!-- Quick Stats -->
    {% if venues %}
    <div class="mt-12 bg-gray-50 rounded-lg p-6">
        <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“Š Quick Stats</h3>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
            <div>
                <div class="text-2xl font-bold text-blue-600">{{ venues|length }}</div>
                <div class="text-sm text-gray-600">Available Venues</div>
            </div>
            <div>
                <div class="text-2xl font-bold text-green-600">
                    {% with venues|first as min_venue %}
                        {% for venue in venues %}
                            {% if venue.capacity < min_venue.capacity %}
                                {% with venue.capacity as min_capacity %}{% endwith %}
                            {% endif %}
                        {% endfor %}
                        {{ min_venue.capacity|floatformat:0 }}
                    {% endwith %}
                </div>
                <div class="text-sm text-gray-600">Min Capacity</div>
            </div>
            <div>
                <div class="text-2xl font-bold text-purple-600">
                    {% with venues|first as max_venue %}
                        {% for venue in venues %}
                            {% if venue.capacity > max_venue.capacity %}
                                {% with venue.capacity as max_capacity %}{% endwith %}
                            {% endif %}
                        {% endfor %}
                        {{ max_venue.capacity|floatformat:0 }}
                    {% endwith %}
                </div>
                <div class="text-sm text-gray-600">Max Capacity</div>
            </div>
            <div>
                <div class="text-2xl font-bold text-orange-600">
                    {% with venues|first as min_rate %}
                        {% for venue in venues %}
                            {% if venue.hourly_rate < min_rate.hourly_rate %}
                                {% with venue.hourly_rate as min_rate_val %}{% endwith %}
                            {% endif %}
                        {% endfor %}
                        K{{ min_rate.hourly_rate|floatformat:0 }}
                    {% endwith %}
                </div>
                <div class="text-sm text-gray-600">From Per Hour</div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}